# ml_hw_1
Выполнение первой домашней работы по машинному обучению.
Описание файлов:
  * HW1_Regression_with_inference.ipynb - ноутбук со всеми проведёнными экспериментами (output’ы ячеек сохранены)
  * fast_api.py - файл с реализацией fast api сервиса.
  * model.pkl - сохраненая обученная модель (ridge_model)
  * scaler.pkl - сохраненая обученный StandardScaler()
  * columns.pkl - Слобцы необходимые для нормализации данных.
  * create_json.py - Код для создания json файла.
  * car_data_test2.json - Созданный тестовый json файл.
  * test.csv - CSV файл для тестирования post(/predict_price/)
  * send_json.py - python код для отправки post запросов с json на fast api сервис.
  * send_csv.py - python код для отправки post запросов с CSV на fast api сервис.

Что было сделано?
В HW1_Regression_with_inference ноутбуке была проведена работа по подготовке данных и обучению моделей. 
А именно:
  * работа с нулевыми значениями, 
  * работа с признаками mileage, engine, max_power и torqu, 
  * заполнение пропусков медианами, 
  * визуализация, 
  * обучение модели на вещественных данных, 
  * Перебор по сетке (c 10-ю фолдами) оптимальные параметры для Lasso-регрессии с помощью GridSearchCV, 
  * Перебором по сетке (c 10-ю фолдами) оптимальные параметры для ElasticNet-регрессии с помощью GridSearchCV,
  * Обучение модели с категориальными признаками,
  * OneHot кодирование,
  * Подбор параметра регуляризации alpha для гребневой (ridge) регрессии с помощью класса GridSearchCV,
  * Бонустная часть,
  * Написание кастомной метрики.

Результаты моделей: 
* Классическую линейная регрессия с дефолтными параметрами: 
  * R^2 для тренировочных данных: 0.5922591702157316, для тестовых данных: 0.5941419794788428.
  * MSE для тренировочных данных: 116874153930.02855, для тестовых данных: 233298779730.45486

* Классическую линейная регрессия с StandardScaler(): 
  * R² Lasso трен:0.5922591701804456, тест: 0.5941408124026637.
  * MSE Lasso трен:116874153940.1429, тест: 233299450599.16928

* Перебор по сетке (c 10-ю фолдами) оптимальные параметры для Lasso-регрессии: Наилучшие параметры: {'alpha': 26609}.
  * R² Lasso трен:0.5825815275124662, тест: 0.5645088242751345.
  * MSE Lasso трен:119648137353.7139, тест: 250332763535.2124.

* Перебором по сетке (c 10-ю фолдами) оптимальные параметры для ElasticNet-регрессии:
  * Наилучшие параметры для ElasticNet: {'alpha': 7.3, 'l1_ratio': 0.98}.
  * R² Lasso трен:0.584864075223263, тест: 0.562360788025413.
  * MSE Lasso трен:118993871670.66849, тест: 251567516110.09885.

* Подбор параметра регуляризации alpha для гребневой (ridge) регрессии:
  * Наилучший параметр alpha для Ridge: {'alpha': 629.5999999999913}
  * R² для Ridge на тренировочных данных: 0.6627470866239251
  * R² для Ridge на тестовых данных: 0.6070631739248527

* Бонусная чать. Мне удалось достич резульатов:
  * Наилучший параметр alpha для Ridge: {'alpha': 1006}.
  * R^2 для Ridge на тренировочных данных: 0.8094379877185709, MSE: 54644393872.05813.
  * R^2 для Ridge на тестовых данных: 0.8008905018141839, MSE: 114453825256.04816.
  * Я сделал:
  * OneHot-кодирования столбцов 'fuel','seller_type','owner', 'transmission','seats'
  * Создал новые признаки km_driven_engine_ratio, km_driven_max_power_ratio, engine_max_power_ratio.
  * К каждому цисловому признаку соделал квадрат. 

 Что дало наибольший буст в качестве?
  * Наибольший буст произошел в бонусной части, при добавлении новых признаков. 

 Что сделать не вышло и почему (это нормально, даже хорошо?)
  * В босуной части, я пытался использовать Логарифмирования признаков и целевого значения. К сожалению, при обучении модели R^2 давала отрицательные значения для трейн и тест дата фреймов.
  * В босуной части, я пытался работать с выбросами. Сделал BotPlot диаграммы, удалил выбрано, но из-за этого значения R^2 стали отличаться на более чем 0.20. Для Трейн 0.76, для тест 0.56. Данные эксперементы были мой определенны как неудачные, и были удаленны из итогового ноутбука.

Скриншоты рабоы fast api сервиса.

![json](https://github.com/IshamUf/ml_hw_1/assets/147190882/122e6825-6626-450b-9827-73d7822c1022)

![CSV](https://github.com/IshamUf/ml_hw_1/assets/147190882/fa82d4c4-799a-48fd-a5ce-67603a7ffa63)


